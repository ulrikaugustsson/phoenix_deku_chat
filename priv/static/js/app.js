!function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){function r(e){return this instanceof r?(this.options={},this.sources={},void(this.element=e)):new r(e)}var o=e("component-emitter");t.exports=r,o(r.prototype),r.prototype.use=function(e){return e(this),this},r.prototype.option=function(e,t){return this.options[e]=t,this},r.prototype.set=function(e,t){return this.sources[e]=t,this.emit("source",e,t),this},r.prototype.mount=function(e){return this.element=e,this.emit("mount",e),this},r.prototype.unmount=function(){return this.element?(this.element=null,this.emit("unmount"),this):void 0}},{"component-emitter":8}],2:[function(e,t,n){t.exports={onBlur:"blur",onChange:"change",onClick:"click",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onFocus:"focus",onInput:"input",onInvalid:"invalid",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onReset:"reset",onScroll:"scroll",onSubmit:"submit",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onWheel:"wheel"}},{}],3:[function(e,t,n){n.tree=n.scene=n.deku=e("./application"),"undefined"!=typeof document&&(n.render=e("./render")),n.renderString=e("./stringify")},{"./application":1,"./render":5,"./stringify":6}],4:[function(e,t,n){var r=e("component-type");t.exports=function(e){var t=r(e);return"null"===t||e===!1?"empty":"object"!==t?"text":"string"===r(e.type)?"element":"component"}},{"component-type":10}],5:[function(e,t,n){function r(e,t,n){function r(){ae(),M(),e.off("unmount",g),e.off("mount",c),e.off("source",b)}function c(){j()}function g(){M(),me=null}function b(e,t){be[e]&&be[e].forEach(function(e){e(t)})}function k(e){re(e),se(e),je[e.id]={},xe[e.id]=e,te(e),V("beforeMount",e,[e.context]),V("beforeRender",e,[e.context]);var t=w(e),n=A(e.id,"0",t);return e.virtualElement=t,e.nativeElement=n,Ee.push(e.id),n}function x(e){var t=xe[e];if(t){V("beforeUnmount",t,[t.context,t.nativeElement]),O(e),he(e);var n=ke[e].entities;delete n[e],delete ke[e],delete xe[e],delete je[e]}}function w(e){var t=e.component,n="function"==typeof t?t:t.render;if(!n)throw new Error("Component needs a render function");var r=n(e.context,E(e));if(!r)throw new Error("Render function must return an element.");return r}function E(e){return function(t){ee(e,t)}}function j(){Ce.batching?de||(de=u(C)):ve||C()}function C(){return S(),ve?void(de=u(C)):(ve=!0,ye?me!==e.element?(ye=I(ge,me,e.element,ye),me=e.element,R(ge)):R(ge):(me=e.element,ye=A(ge,"0",me),t.children.length>0&&console.info("deku: The container element is not empty. These elements will be removed. Read more: http://cl.ly/b0Sr"),t===document.body&&console.warn("deku: Using document.body is allowed but it can cause some issues. Read more: http://cl.ly/b0SC"),Q(t),t.appendChild(ye)),T(),void(ve=!1))}function T(){for(;Ee.length>0;){var e=Ee.shift(),t=xe[e];V("afterRender",t,[t.context,t.nativeElement]),V("afterMount",t,[t.context,t.nativeElement,E(t)])}}function S(){de&&(u.cancel(de),de=0)}function _(e){var t=xe[e];if(se(t),!ne(t))return te(t),R(e);var n=t.virtualElement,r=t.pendingProps,o=t.pendingState,i=t.context.state,s=t.context.props;V("beforeUpdate",t,[t.context,r,o]),V("beforeRender",t,[t.context]),te(t);var u=w(t);return u===n?R(e):(t.nativeElement=I(e,n,u,t.nativeElement),t.virtualElement=u,R(e),V("afterRender",t,[t.context,t.nativeElement]),void V("afterUpdate",t,[t.context,s,i,E(t)]))}function R(e){d(je[e],function(e){_(e)})}function O(e){d(je[e],function(e){x(e)})}function M(){S(),z(ge,"0",ye),ye=null}function A(e,t,n){switch(y(n)){case"text":return P(n);case"empty":return L(e,t);case"element":return N(e,t,n);case"component":return H(e,t,n)}}function P(e){return document.createTextNode(e)}function N(e,t,n){var r,o=n.attributes,i=n.type,s=n.children;return r=h.isElement(i)?document.createElementNS(h.namespace,i):document.createElement(i),d(o,function(n,o){G(e,t,r,o,n)}),d(s,function(n,o){var i=A(e,t+"."+o,n);i.parentNode||r.appendChild(i)}),r.__entity__=e,r.__path__=t,r}function L(e,t){var n=document.createElement("noscript");return n.__entity__=e,n.__path__=t,n}function H(e,t,n){var r=new o(n.type,v({children:n.children},n.attributes),e);return je[e][t]=r.id,k(r)}function I(e,t,n,r){return U("0",e,t,n,r)}function U(e,t,n,r,o){var i=y(n),s=y(r);if(i!==s)return $(t,e,o,r);switch(s){case"text":return q(n,r,o);case"empty":return o;case"element":return F(e,t,n,r,o);case"component":return J(e,t,n,r,o)}}function q(e,t,n){return t!==e&&(n.data=t),n}function D(e,t,n,r,o){function i(e,t,n){return t&&t.attributes&&null!=t.attributes.key&&(e[t.attributes.key]={element:t,index:n},u=!0),e}var s=[],u=!1,a=Array.prototype.slice.apply(o.childNodes),c=m(n.children,i,{}),l=m(r.children,i,{}),f=v({},je[t]);if(u)d(c,function(n,r){if(null==l[r]){var o=e+"."+n.index;z(t,o,a[n.index])}}),d(l,function(n,r){var o=c[r];if(null!=o){var i=e+"."+o.index;s[n.index]=U(i,t,o.element,n.element,a[o.index])}}),d(l,function(n,r){var o=c[r];if(null!=o&&o.index!==n.index){var i=e+"."+n.index,s=e+"."+o.index;d(f,function(e,n){s===n&&(delete je[t][n],je[t][i]=e)})}}),d(l,function(n,r){var o=e+"."+n.index;null==c[r]&&(s[n.index]=A(t,o,n.element))});else for(var h=Math.max(n.children.length,r.children.length),p=0;h>p;p++){var y=n.children[p],g=r.children[p];void 0!==g?s[p]=void 0!==y?U(e+"."+p,t,y,g,a[p]):A(t,e+"."+p,g):z(t,e+"."+p,a[p])}d(s,function(e,t){var n=o.childNodes[t];e&&e!==n&&(n?o.insertBefore(e,n):o.appendChild(e))})}function B(e,t,n,r,o){var i=t.attributes,s=e.attributes;d(i,function(e,t){!f[t]&&t in s&&s[t]===e||G(r,o,n,t,e)}),d(s,function(e,t){t in i||K(r,o,n,t)})}function J(e,t,n,r,o){if(r.type!==n.type)return $(t,e,o,r);var i=je[t][e];return i&&Z(i,v({children:r.children},r.attributes)),o}function F(e,t,n,r,o){return r.type!==n.type?$(t,e,o,r):(B(n,r,o,t,e),D(e,t,n,r,o),o)}function z(e,t,n){var r=je[e],o=r[t],i=we[e]||{},s=[];if(o){var u=xe[o];n=u.nativeElement,x(o),s.push(t)}else{if(!Y(n))return n&&n.parentNode.removeChild(n);d(r,function(e,n){(n===t||W(t,n))&&(x(e),s.push(n))}),d(i,function(n,r){(r===t||W(t,r))&&fe(e,r)})}d(s,function(t){delete je[e][t]}),n.parentNode.removeChild(n)}function $(e,t,n,r){var o=n.parentNode,i=Array.prototype.indexOf.call(o.childNodes,n);z(e,t,n);var s=A(e,t,r),u=o.childNodes[i];return u?o.insertBefore(s,u):o.appendChild(s),"root"!==e&&"0"===t&&X(e,s),s}function X(e,t){var n=xe[e];"root"!==n.ownerId&&je[n.ownerId][0]===e&&(xe[n.ownerId].nativeElement=t,X(n.ownerId,t))}function G(e,t,n,r,o){if(!o)return void K(e,t,n,r);if(f[r])return void le(e,t,f[r],o);switch(r){case"checked":case"disabled":case"selected":n[r]=!0;break;case"innerHTML":n.innerHTML=o;break;case"value":s(n,o);break;case h.isAttribute(r):n.setAttributeNS(h.namespace,r,o);break;default:n.setAttribute(r,o)}}function K(e,t,n,r){if(f[r])return void fe(e,t,f[r]);switch(r){case"checked":case"disabled":case"selected":n[r]=!1;break;case"innerHTML":n.innerHTML="";case"value":s(n,null);break;default:n.removeAttribute(r)}}function W(e,t){return 0===t.indexOf(e+".")}function Y(e){return!(!e||!e.tagName)}function Q(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function V(e,t,n){return"function"==typeof t.component[e]?t.component[e].apply(null,n):void 0}function Z(e,t){var n=xe[e];n.pendingProps=p({},t,n.component.defaultProps||{}),n.dirty=!0,j()}function ee(e,t){e.pendingState=v(e.pendingState,t),e.dirty=!0,j()}function te(e){e.context={state:e.pendingState,props:e.pendingProps,id:e.id},e.pendingState=v({},e.context.state),e.pendingProps=v({},e.context.props),e.dirty=!1,"function"==typeof e.component.validate&&e.component.validate(e.context)}function ne(e){if(!e.dirty)return!1;if(!e.component.shouldUpdate)return!0;var t=e.pendingProps,n=e.pendingState,r=e.component.shouldUpdate(e.context,t,n);return r}function re(e){oe(e);var t=e.component;t.registered||(ie(e),t.registered=!0)}function oe(e){var t=e.component,n=t.entities=t.entities||{};n[e.id]=e,ke[e.id]=t}function ie(e){var t=ke[e.id],n=t.sources;if(!n){var r=t.entities,o=t.sourceToPropertyName={};t.sources=n=[];var i=t.propTypes;for(var s in i){var u=i[s];u&&u.source&&(n.push(u.source),o[u.source]=s)}n.forEach(function(e){function t(t){var n=o[e];for(var i in r){var s=r[i],u={};u[n]=t,Z(i,v(s.pendingProps,u))}}be[e]=be[e]||[],be[e].push(t)})}}function se(t){var n=t.component,r=n.sourceToPropertyName,o=n.sources;o.forEach(function(n){var o=r[n];null==t.pendingProps[o]&&(t.pendingProps[o]=e.sources[n])})}function ue(){d(f,function(e){Te.addEventListener(e,ce,!0)})}function ae(){d(f,function(e){Te.removeEventListener(e,ce,!0)})}function ce(e){for(var t=e.target,n=e.type;t;){var r=l.get(we,[t.__entity__,t.__path__,n]);if(r&&(e.delegateTarget=t,r(e)===!1))break;t=t.parentNode}}function le(e,t,n,r){l.set(we,[e,t,n],function(t){var n=xe[e];n?r.call(null,t,n.context,E(n)):r.call(null,t)})}function fe(e,t,n){var r=[e];t&&r.push(t),n&&r.push(n),l.del(we,r)}function he(e){l.del(we,[e])}function pe(){return{entities:xe,handlers:we,connections:be,currentElement:me,options:Ce,app:e,container:t,children:je}}var de,ve,me,ye,ge="root",be={},ke={},xe={},we={},Ee=[],je={};if(je[ge]={},!a(t))throw new Error("Container element must be a DOM element");var Ce=p(v({},e.options||{},n||{}),{batching:!0}),Te=i(t);return ue(),e.on("unmount",g),e.on("mount",c),e.on("source",b),e.element&&C(),{remove:r,inspect:pe}}function o(e,t,n){this.id=c(),this.ownerId=n,this.component=e,this.propTypes=e.propTypes||{},this.context={},this.context.id=this.id,this.context.props=p(t||{},e.defaultProps||{}),this.context.state=this.component.initialState?this.component.initialState(this.context.props):{},this.pendingProps=v({},this.context.props),this.pendingState=v({},this.context.state),this.dirty=!1,this.virtualElement=null,this.nativeElement=null,this.displayName=e.name||"Component"}function i(e){for(;e.parentElement;){if("BODY"===e.tagName||!e.parentElement)return e;e=e.parentElement}return e}function s(e,t){if("INPUT"!==e.tagName)return void(e.value=t);var n=e.selectionStart,r=e.selectionEnd;e.value=t,e.setSelectionRange(n,r)}var u=e("component-raf"),a=e("is-dom"),c=e("get-uid"),l=e("object-path"),f=e("./events"),h=e("./svg"),p=e("object-defaults"),d=e("fast.js/forEach"),v=e("fast.js/object/assign"),m=e("fast.js/reduce"),y=e("./node-type");t.exports=r},{"./events":2,"./node-type":4,"./svg":7,"component-raf":9,"fast.js/forEach":13,"fast.js/object/assign":16,"fast.js/reduce":19,"get-uid":20,"is-dom":21,"object-defaults":24,"object-path":25}],6:[function(e,t,n){function r(e){var t="";for(var n in e){var r=e[n];"innerHTML"!==n&&i(r)&&(t+=o(n,e[n]))}return t}function o(e,t){return" "+e+'="'+t+'"'}function i(e){var t=a(e);return"string"===t||"boolean"===t||"number"===t}var s=e("object-defaults"),u=e("./node-type"),a=e("component-type");t.exports=function(e){function t(t,r){var o=t.propTypes||{},i=s(r||{},t.defaultProps||{}),u=t.initialState?t.initialState(i):{};for(var a in o){var c=o[a];c.source&&(i[a]=e.sources[c.source])}t.beforeMount&&t.beforeMount({props:i,state:u}),t.beforeRender&&t.beforeRender({props:i,state:u});var l=t.render({props:i,state:u});return n(l,"0")}function n(e,o){switch(u(e)){case"empty":return"<noscript />";case"text":return e;case"element":var i=e.children,s=e.attributes,a=e.type,c=s.innerHTML,l="<"+a+r(s)+">";if(c)l+=c;else for(var f=0,h=i.length;h>f;f++)l+=n(i[f],o+"."+f);return l+="</"+a+">";case"component":return t(e.type,e.attributes)}throw new Error("Invalid type")}if(!e.element)throw new Error("No element mounted");return n(e.element,"0")}},{"./node-type":4,"component-type":10,"object-defaults":24}],7:[function(e,t,n){t.exports={isElement:e("is-svg-element").isElement,isAttribute:e("is-svg-attribute"),namespace:"http://www.w3.org/2000/svg"}},{"is-svg-attribute":22,"is-svg-element":23}],8:[function(e,t,n){function r(e){return e?o(e):void 0}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],9:[function(e,t,n){function r(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-o)),r=setTimeout(e,n);return o=t,r}n=t.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||r;var o=(new Date).getTime(),i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout;n.cancel=function(e){i.call(window,e)}},{}],10:[function(e,t,n){var r=Object.prototype.toString;t.exports=function(e){switch(r.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!==e?"nan":e&&1===e.nodeType?"element":(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),typeof e)}},{}],11:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,i=e.length,s=void 0!==n?r(t,n):t;for(o=0;i>o;o++)s(e[o],o,e)}},{"../function/bindInternal3":14}],12:[function(e,t,n){"use strict";var r=e("../function/bindInternal4");t.exports=function(e,t,n,o){var i,s,u=e.length,a=void 0!==o?r(t,o):t;for(void 0===n?(i=1,s=e[0]):(i=0,s=n);u>i;i++)s=a(s,e[i],i,e);return s}},{"../function/bindInternal4":15}],13:[function(e,t,n){"use strict";var r=e("./array/forEach"),o=e("./object/forEach");t.exports=function(e,t,n){return e instanceof Array?r(e,t,n):o(e,t,n)}},{"./array/forEach":11,"./object/forEach":17}],14:[function(e,t,n){"use strict";t.exports=function(e,t){return function(n,r,o){return e.call(t,n,r,o)}}},{}],15:[function(e,t,n){"use strict";t.exports=function(e,t){return function(n,r,o,i){return e.call(t,n,r,o,i)}}},{}],16:[function(e,t,n){"use strict";t.exports=function(e){var t,n,r,o,i,s,u=arguments.length;for(n=1;u>n;n++)for(t=arguments[n],o=Object.keys(t),r=o.length,s=0;r>s;s++)i=o[s],e[i]=t[i];return e}},{}],17:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,i,s=Object.keys(e),u=s.length,a=void 0!==n?r(t,n):t;for(i=0;u>i;i++)o=s[i],a(e[o],o,e)}},{"../function/bindInternal3":14}],18:[function(e,t,n){"use strict";var r=e("../function/bindInternal4");t.exports=function(e,t,n,o){var i,s,u,a=Object.keys(e),c=a.length,l=void 0!==o?r(t,o):t;for(void 0===n?(i=1,u=e[a[0]]):(i=0,u=n);c>i;i++)s=a[i],u=l(u,e[s],s,e);return u}},{"../function/bindInternal4":15}],19:[function(e,t,n){"use strict";var r=e("./array/reduce"),o=e("./object/reduce");t.exports=function(e,t,n,i){return e instanceof Array?r(e,t,n,i):o(e,t,n,i)}},{"./array/reduce":12,"./object/reduce":18}],20:[function(e,t,n){var r=Date.now()%1e9;t.exports=function(){return(1e9*Math.random()>>>0)+r++}},{}],21:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e?window&&"object"==typeof window.Node?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName:!1}},{}],22:[function(e,t,n){n.attributes={cx:!0,cy:!0,d:!0,dx:!0,dy:!0,fill:!0,fillOpacity:!0,fontFamily:!0,fontSize:!0,fx:!0,fy:!0,gradientTransform:!0,gradientUnits:!0,markerEnd:!0,markerMid:!0,markerStart:!0,offset:!0,opacity:!0,patternContentUnits:!0,patternUnits:!0,points:!0,preserveAspectRatio:!0,r:!0,rx:!0,ry:!0,spreadMethod:!0,stopColor:!0,stopOpacity:!0,stroke:!0,strokeDasharray:!0,strokeLinecap:!0,strokeOpacity:!0,strokeWidth:!0,textAnchor:!0,transform:!0,version:!0,viewBox:!0,x1:!0,x2:!0,x:!0,y1:!0,y2:!0,y:!0},t.exports=function(e){return e in n.attributes}},{}],23:[function(e,t,n){n.elements={animate:!0,circle:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,mask:!0,path:!0,pattern:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,svg:!0,text:!0,tspan:!0},n.isElement=function(e){return e in n.elements}},{}],24:[function(e,t,n){"use strict";t.exports=function(e){e=e||{};for(var t=1;t<arguments.length;t++){var n=arguments[t];n&&Object.getOwnPropertyNames(n).forEach(function(t){void 0===e[t]&&(e[t]=n[t])})}return e}},{}],25:[function(e,t,n){!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=n():"function"==typeof define&&define.amd?define([],n):e.objectPath=n()}(this,function(){"use strict";function e(e){if(!e)return!0;if(i(e)&&0===e.length)return!0;if(!r(e)){for(var t in e)if(f.call(e,t))return!1;return!0}return!1}function t(e){return l.call(e)}function n(e){return"number"==typeof e||"[object Number]"===t(e)}function r(e){return"string"==typeof e||"[object String]"===t(e)}function o(e){return"object"==typeof e&&"[object Object]"===t(e)}function i(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===t(e)}function s(e){return"boolean"==typeof e||"[object Boolean]"===t(e)}function u(e){var t=parseInt(e);return t.toString()===e?t:e}function a(t,o,i,s){if(n(o)&&(o=[o]),e(o))return t;if(r(o))return a(t,o.split(".").map(u),i,s);var c=o[0];if(1===o.length){var l=t[c];return void 0!==l&&s||(t[c]=i),l}return void 0===t[c]&&(t[c]=n(o[1])?[]:{}),a(t[c],o.slice(1),i,s)}function c(t,o){if(n(o)&&(o=[o]),e(t))return void 0;if(e(o))return t;if(r(o))return c(t,o.split("."));var s=u(o[0]),a=t[s];if(1===o.length)void 0!==a&&(i(t)?t.splice(s,1):delete t[s]);else if(void 0!==t[s])return c(t[s],o.slice(1));return t}var l=Object.prototype.toString,f=Object.prototype.hasOwnProperty,h=function(e){return Object.keys(h).reduce(function(t,n){return"function"==typeof h[n]&&(t[n]=h[n].bind(h,e)),t},{})};return h.has=function(t,s){if(e(t))return!1;if(n(s)?s=[s]:r(s)&&(s=s.split(".")),e(s)||0===s.length)return!1;for(var u=0;u<s.length;u++){var a=s[u];if(!o(t)&&!i(t)||!f.call(t,a))return!1;t=t[a]}return!0},h.ensureExists=function(e,t,n){return a(e,t,n,!0)},h.set=function(e,t,n,r){return a(e,t,n,r)},h.insert=function(e,t,n,r){var o=h.get(e,t);r=~~r,i(o)||(o=[],h.set(e,t,o)),o.splice(r,0,n)},h.empty=function(t,u){if(e(u))return t;if(e(t))return void 0;var a,c;if(!(a=h.get(t,u)))return t;if(r(a))return h.set(t,u,"");if(s(a))return h.set(t,u,!1);if(n(a))return h.set(t,u,0);if(i(a))a.length=0;else{if(!o(a))return h.set(t,u,null);for(c in a)f.call(a,c)&&delete a[c]}},h.push=function(e,t){var n=h.get(e,t);i(n)||(n=[],h.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},h.coalesce=function(e,t,n){for(var r,o=0,i=t.length;i>o;o++)if(void 0!==(r=h.get(e,t[o])))return r;return n},h.get=function(t,o,i){if(n(o)&&(o=[o]),e(o))return t;if(e(t))return i;if(r(o))return h.get(t,o.split("."),i);var s=u(o[0]);return 1===o.length?void 0===t[s]?i:t[s]:h.get(t[s],o.slice(1),i)},h.del=function(e,t){return c(e,t)},h})},{}],26:[function(e,t,n){function r(e,t,n){if(!e)throw new TypeError("element() needs a type.");return 2!==arguments.length||"string"!=typeof t&&!Array.isArray(t)||(n=t,t={}),arguments.length>2&&Array.isArray(arguments[2])===!1&&(n=o(arguments,2)),n=n||[],t=t||{},Array.isArray(n)||(n=[n]),n=i(n,2),{type:e,children:n,attributes:t}}var o=e("sliced"),i=e("array-flatten");t.exports=r},{"array-flatten":27,sliced:28}],27:[function(e,t,n){"use strict";function r(e,t,n){for(var o=0;o<e.length;o++){var i=e[o];n>0&&Array.isArray(i)?r(i,t,n-1):t.push(i)}return t}function o(e,t){for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?o(r,t):t.push(r)}return t}function i(e,t){return null==t?o(e,[]):r(e,[],t)}t.exports=i},{}],28:[function(e,t,n){t.exports=n=e("./lib/sliced")},{"./lib/sliced":29}],29:[function(e,t,n){t.exports=function(e,t,n){var r=[],o=e.length;if(0===o)return r;var i=0>t?Math.max(0,t+o):t||0;for(void 0!==n&&(o=0>n?n+o:n);o-->i;)r[o-i]=e[o];return r}},{}],30:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=e("../vendor/phoenix.js"),i=e("virtual-element"),s=r(i),u=e("deku"),a=e("./messages"),c=r(a),l=[],f=u.tree(s["default"](c["default"],{messages:[]}));f.set("messages",l),console.log(f),u.render(f,document.querySelector("#messages"));var h=new o.Socket("/socket",{logger:function(e,t,n){console.log(e+": "+t,n)}});h.connect({user_id:"123"});var p=(document.querySelector("#status"),document.querySelector("#message-input")),d=document.querySelector("#username");h.onOpen(function(e){return console.log("OPEN",e)}),h.onError(function(e){return console.log("ERROR",e)}),h.onClose(function(e){return console.log("CLOSE",e)});var v=h.channel("rooms:lobby",{});v.join().receive("ignore",function(){return console.log("auth error")}).receive("ok",function(){return console.log("join ok")}).after(1e4,function(){return console.log("Connection interruption")}),v.onError(function(e){return console.log("something went wrong",e)}),v.onClose(function(e){return console.log("channel closed",e)}),p.removeEventListener("keypress"),p.addEventListener("keypress",function(e){13==e.keyCode&&(v.push("new:msg",{user:d.value,body:p.value}),p.value="")}),v.on("new:msg",function(e){l.push(e),f.set("messages",l)}),v.on("user:entered",function(e){e.user=e.user||"anonymous",l.push(e),f.set("messages",l)})},{"../vendor/phoenix.js":32,"./messages":31,deku:3,"virtual-element":26}],31:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("virtual-element"),i=r(o),s={propTypes:{messages:{source:"messages"}},render:function(e){var t=e.props,n=t.messages,r=(t.mountEle,n.map(function(e){return i["default"]("p",null,"[",i["default"]("a",{href:"#"},"@",e.user),"]: ",e.body)}));return i["default"]("div",{style:"overflow: auto; height: 100%;"},r)},afterRender:function(e,t){t.scrollTop=t.scrollHeight}};n["default"]=s,t.exports=n["default"]},{"virtual-element":26}],32:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i={connecting:0,open:1,closing:2,closed:3},s={closed:"closed",errored:"errored",joined:"joined",joining:"joining"},u={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},a={longpoll:"longpoll",websocket:"websocket"},c=function(){function e(t,n,o){r(this,e),this.channel=t,this.event=n,this.payload=o||{},this.receivedResp=null,this.afterHook=null,this.recHooks=[],this.sent=!1}return o(e,[{key:"send",value:function(){var e=this,t=this.channel.socket.makeRef();this.refEvent=this.channel.replyEventName(t),this.receivedResp=null,this.sent=!1,this.channel.on(this.refEvent,function(t){e.receivedResp=t,e.matchReceive(t),e.cancelRefEvent(),e.cancelAfter()}),this.startAfter(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:t})}},{key:"receive",value:function(e,t){return this.receivedResp&&this.receivedResp.status===e&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}},{key:"after",value:function(e,t){if(this.afterHook)throw"only a single after hook can be applied to a push";var n=null;return this.sent&&(n=setTimeout(t,e)),this.afterHook={ms:e,callback:t,timer:n},this}},{key:"matchReceive",value:function(e){{var t=e.status,n=e.response;e.ref}this.recHooks.filter(function(e){return e.status===t}).forEach(function(e){return e.callback(n)})}},{key:"cancelRefEvent",value:function(){this.channel.off(this.refEvent)}},{key:"cancelAfter",value:function(){this.afterHook&&(clearTimeout(this.afterHook.timer),this.afterHook.timer=null)}},{key:"startAfter",value:function(){var e=this;if(this.afterHook){var t=function(){e.cancelRefEvent(),e.afterHook.callback()};this.afterHook.timer=setTimeout(t,this.afterHook.ms)}}}]),e}(),l=function(){function e(t,n,o){var i=this;r(this,e),this.state=s.closed,this.topic=t,this.params=n||{},this.socket=o,this.bindings=[],this.joinedOnce=!1,this.joinPush=new c(this,u.join,this.params),this.pushBuffer=[],this.rejoinTimer=new d(function(){return i.rejoinUntilConnected()},this.socket.reconnectAfterMs),this.joinPush.receive("ok",function(){i.state=s.joined,i.rejoinTimer.reset()}),this.onClose(function(){i.socket.log("channel","close "+i.topic),i.state=s.closed,i.socket.remove(i)}),this.onError(function(e){i.socket.log("channel","error "+i.topic,e),i.state=s.errored,i.rejoinTimer.setTimeout()}),this.on(u.reply,function(e,t){i.trigger(i.replyEventName(t),e)})}return o(e,[{key:"rejoinUntilConnected",value:function(){this.rejoinTimer.setTimeout(),this.socket.isConnected()&&this.rejoin()}},{key:"join",value:function(){if(this.joinedOnce)throw"tried to join multiple times. 'join' can only be called a single time per channel instance";return this.joinedOnce=!0,this.sendJoin(),this.joinPush}},{key:"onClose",value:function(e){this.on(u.close,e)}},{key:"onError",value:function(e){this.on(u.error,function(t){return e(t)})}},{key:"on",value:function(e,t){this.bindings.push({event:e,callback:t})}},{key:"off",value:function(e){this.bindings=this.bindings.filter(function(t){return t.event!==e})}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.state===s.joined}},{key:"push",value:function(e,t){if(!this.joinedOnce)throw"tried to push '"+e+"' to '"+this.topic+"' before joining. Use channel.join() before pushing events";var n=new c(this,e,t);return this.canPush()?n.send():this.pushBuffer.push(n),n}},{key:"leave",value:function(){var e=this;return this.push(u.leave).receive("ok",function(){e.socket.log("channel","leave "+e.topic),e.trigger(u.close,"leave")})}},{key:"onMessage",value:function(e,t,n){}},{key:"isMember",value:function(e){return this.topic===e}},{key:"sendJoin",value:function(){this.state=s.joining,this.joinPush.send()}},{key:"rejoin",value:function(){this.sendJoin(),this.pushBuffer.forEach(function(e){return e.send()}),this.pushBuffer=[]}},{key:"trigger",value:function(e,t,n){this.onMessage(e,t,n),this.bindings.filter(function(t){return t.event===e}).map(function(e){return e.callback(t,n)})}},{key:"replyEventName",value:function(e){return"chan_reply_"+e}}]),e}();n.Channel=l;var f=function(){function e(t){var n=this,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.transport=o.transport||window.WebSocket||h,this.heartbeatIntervalMs=o.heartbeatIntervalMs||3e4,this.reconnectAfterMs=o.reconnectAfterMs||function(e){return[1e3,5e3,1e4][e-1]||1e4},this.logger=o.logger||function(){},this.longpollerTimeout=o.longpollerTimeout||2e4,this.params={},this.reconnectTimer=new d(function(){return n.connect(n.params)},this.reconnectAfterMs),this.endPoint=t+"/"+a.websocket}return o(e,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var e=p.appendParams(this.endPoint,this.params);return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?this.protocol()+":"+e:this.protocol()+"://"+location.host+e}},{key:"disconnect",value:function(e,t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n||""):this.conn.close(),this.conn=null),e&&e()}},{key:"connect",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.params=t,this.disconnect(function(){e.conn=new e.transport(e.endPointURL()),e.conn.timeout=e.longpollerTimeout,e.conn.onopen=function(){return e.onConnOpen()},e.conn.onerror=function(t){return e.onConnError(t)},e.conn.onmessage=function(t){return e.onConnMessage(t)},e.conn.onclose=function(t){return e.onConnClose(t)}})}},{key:"log",value:function(e,t,n){this.logger(e,t,n)}},{key:"onOpen",value:function(e){this.stateChangeCallbacks.open.push(e)}},{key:"onClose",value:function(e){this.stateChangeCallbacks.close.push(e)}},{key:"onError",value:function(e){this.stateChangeCallbacks.error.push(e)}},{key:"onMessage",value:function(e){this.stateChangeCallbacks.message.push(e)}},{key:"onConnOpen",value:function(){var e=this;this.log("transport","connected to "+this.endPointURL(),this.transport.prototype),this.flushSendBuffer(),this.reconnectTimer.reset(),this.conn.skipHeartbeat||(clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(function(){return e.sendHeartbeat()},this.heartbeatIntervalMs)),this.stateChangeCallbacks.open.forEach(function(e){return e()})}},{key:"onConnClose",value:function(e){this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.reconnectTimer.setTimeout(),this.stateChangeCallbacks.close.forEach(function(t){return t(e)})}},{key:"onConnError",value:function(e){this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach(function(t){return t(e)})}},{key:"triggerChanError",value:function(){this.channels.forEach(function(e){return e.trigger(u.error)})}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case i.connecting:return"connecting";case i.open:return"open";case i.closing:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return"open"===this.connectionState()}},{key:"remove",value:function(e){this.channels=this.channels.filter(function(t){return!t.isMember(e.topic)})}},{key:"channel",value:function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=new l(e,n,this);return this.channels.push(t),t}},{key:"push",value:function(e){var t=this,n=e.topic,r=e.event,o=e.payload,i=e.ref,s=function(){return t.conn.send(JSON.stringify(e))};this.log("push",n+" "+r+" ("+i+")",o),this.isConnected()?s():this.sendBuffer.push(s)}},{key:"makeRef",value:function(){var e=this.ref+1;return this.ref=e===this.ref?0:e,this.ref.toString()}},{key:"sendHeartbeat",value:function(){this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.makeRef()})}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(function(e){return e()}),this.sendBuffer=[])}},{key:"onConnMessage",value:function(e){var t=JSON.parse(e.data),n=t.topic,r=t.event,o=t.payload,i=t.ref;this.log("receive",(o.status||"")+" "+n+" "+r+" "+(i&&"("+i+")"||""),o),this.channels.filter(function(e){return e.isMember(n)}).forEach(function(e){return e.trigger(r,o,i)}),this.stateChangeCallbacks.message.forEach(function(e){
return e(t)})}}]),e}();n.Socket=f;var h=function(){function e(t){r(this,e),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(t),this.readyState=i.connecting,this.poll()}return o(e,[{key:"normalizeEndpoint",value:function(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+a.websocket),"$1/"+a.longpoll)}},{key:"endpointURL",value:function(){return p.appendParams(this.pollEndpoint,{token:this.token,format:"json"})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=i.connecting}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var e=this;(this.readyState===i.open||this.readyState===i.connecting)&&p.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),function(t){if(t){var n=t.status,r=t.token,o=t.messages;e.token=r}else var n=0;switch(n){case 200:o.forEach(function(t){return e.onmessage({data:JSON.stringify(t)})}),e.poll();break;case 204:e.poll();break;case 410:e.readyState=i.open,e.onopen(),e.poll();break;case 0:case 500:e.onerror(),e.closeAndRetry();break;default:throw"unhandled poll status "+n}})}},{key:"send",value:function(e){var t=this;p.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),function(e){e&&200===e.status||(t.onerror(status),t.closeAndRetry())})}},{key:"close",value:function(e,t){this.readyState=i.closed,this.onclose()}}]),e}();n.LongPoll=h;var p=function(){function e(){r(this,e)}return o(e,null,[{key:"request",value:function(e,t,n,r,o,i,s){if(window.XDomainRequest){var u=new XDomainRequest;this.xdomainRequest(u,e,t,r,o,i,s)}else{var u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(u,e,t,n,r,o,i,s)}}},{key:"xdomainRequest",value:function(e,t,n,r,o,i,s){var u=this;e.timeout=o,e.open(t,n),e.onload=function(){var t=u.parseJSON(e.responseText);s&&s(t)},i&&(e.ontimeout=i),e.onprogress=function(){},e.send(r)}},{key:"xhrRequest",value:function(e,t,n,r,o,i,s,u){var a=this;e.timeout=i,e.open(t,n,!0),e.setRequestHeader("Content-Type",r),e.onerror=function(){u&&u(null)},e.onreadystatechange=function(){if(e.readyState===a.states.complete&&u){var t=a.parseJSON(e.responseText);u(t)}},s&&(e.ontimeout=s),e.send(o)}},{key:"parseJSON",value:function(e){return e&&""!==e?JSON.parse(e):null}},{key:"serialize",value:function(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=t?t+"["+r+"]":r,i=e[r];n.push("object"==typeof i?this.serialize(i,o):encodeURIComponent(o)+"="+encodeURIComponent(i))}return n.join("&")}},{key:"appendParams",value:function(e,t){if(0===Object.keys(t).length)return e;var n=e.match(/\?/)?"&":"?";return""+e+n+this.serialize(t)}}]),e}();n.Ajax=p,p.states={complete:4};var d=function(){function e(t,n){r(this,e),this.callback=t,this.timerCalc=n,this.timer=null,this.tries=0}return o(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"setTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.tries=e.tries+1,e.callback()},this.timerCalc(this.tries+1))})}]),e}()},{}]},{},[30]);
//# sourceMappingURL=app.js.map